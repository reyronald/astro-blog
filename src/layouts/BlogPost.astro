---
import { Image } from 'astro:assets'
import type { CollectionEntry } from 'astro:content'
import FormattedDate from '../components/FormattedDate.astro'
import BaseLayout from './BaseLayout.astro'
import Header from '../components/Header.astro'
import Tag from '../components/Tag.astro'

type Props = CollectionEntry<'blog'>['data'] & { id: string }

const { title, pubDate, heroImage, tags, blurhash } = Astro.props
---

<BaseLayout>
  <Header />

  <main>
    <div class="w-full mx-auto max-h-120 overflow-hidden">
      {
        heroImage && (
          <Image
            width={1000}
            height={420}
            src={heroImage}
            alt={title}
            class="w-full object-cover aspect-1000/420 object-bottom"
            data-blurhash={blurhash}
          />
        )
      }
    </div>

    <article class="py-12 space-y-4">
      <h1 class="text-6xl font-bold text-slate-300">{title}</h1>

      <div class="text-slate-400 text-lg">
        Ronald Rey / <FormattedDate date={pubDate} />
      </div>

      {tags.map((tag) => <Tag tag={tag} />)}

      <hr class="my-8" />

      <div class="text-justify space-y-8">
        <slot />
      </div>
    </article>

    <a href="/" class="text-center block pb-16 hover:text-slate-100">‚Üê Back to home</a>
  </main>
</BaseLayout>

<style is:global>
  h2 {
    font-size: 3rem;
    font-weight: bold;
    text-align: left;
    color: var(--color-slate-300);
  }

  article {
    --w: 900px; /* the max-width */
    --m: 1em; /* margin on small screen */
    --_m: max(var(--m), 50cqw - var(--w)/2);

    margin-inline: var(--_m);

    a {
      text-decoration: underline;

      &:hover {
        color: var(--color-slate-100);
      }
    }
  }

  pre {
    margin-inline: min(-1 * var(--m), var(--w) / 2 - 50cqw);
    padding: 1rem;
    display: grid;
    place-items: center;
    overflow-x: auto;
  }

  pre code {
    display: block;
    min-width: min-content;
  }

  ol li {
    list-style: decimal;
    margin-left: 1.5rem;
  }
</style>

<script>
  import '../utils/blurhash'
</script>
